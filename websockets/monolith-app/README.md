# WebSocket 聊天应用

这是一个基于 WebSocket 的简单实时聊天应用。所有核心功能，包括连接管理和消息广播，都在一个单独的 `app.js` 文件中实现。

## ✨ 功能

-   **实时消息**：客户端可以连接到服务器并实时发送和接收消息。
-   **消息广播**：一个客户端发送的消息会被广播给所有其他在线的客户端。
-   **连接管理**：服务器会跟踪所有活跃的连接，并在客户端断开时进行清理。

## 🚀 如何开始

### 1. 前提条件

-   确保你的电脑上已经安装了 [Node.js](https://nodejs.org/) (建议版本：18.x 或更高)。

### 2. 安装依赖

进入 `monolith-app` 文件夹，然后运行以下命令来安装项目所需的库（主要是 `ws`）：

```bash
npm install
```

### 3. 启动服务器

安装完成后，运行以下命令来启动聊天服务器：

```bash
npm start
```

如果一切顺利，你会在终端看到服务器成功启动的提示，它会监听在 `8080` 端口。

```
==============================================
WebSocket聊天服务器已启动
监听端口: 8080
连接地址: ws://localhost:8080
==============================================
```

## 🛠️ 如何测试

你可以使用任何支持 WebSocket 的客户端工具来测试，这里推荐使用 `wscat`，它是一个方便的命令行工具。

### 1. 安装 wscat

如果你还没有安装过 `wscat`，可以打开一个新的终端，运行以下命令进行全局安装：

```bash
npm install -g wscat
```

### 2. 连接到聊天室

打开终端，使用以下命令连接到你刚刚启动的聊天服务器：

```bash
wscat -c ws://localhost:8080
```

连接成功后，你会看到一条提示 `connected (press CTRL+C to quit)`。

为了模拟多人聊天，你可以多打开几个终端窗口，并用同样的命令连接到服务器。

### 3. 发送消息

在任何一个连接成功的终端里，输入以下格式的 JSON 内容，然后按下回车键：

```json
{"action":"sendmessage", "data":"大家好，我是新来的！"}
```

发送成功后，你会看到所有打开的终端窗口（包括你自己这个）都会收到 `大家好，我是新来的！` 这条消息。这说明消息广播功能正常工作！
